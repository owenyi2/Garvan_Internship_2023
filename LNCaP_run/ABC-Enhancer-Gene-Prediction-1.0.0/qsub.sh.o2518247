Running command: awk 'BEGIN {FS=OFS="\t"} (substr($1, length($1)) == "X" || substr($1, length($1)) == "Y") { $4 *= 2 } 1' results/LNCaP/Peaks/macs2_peaks.narrowPeak.sorted.USC20140207_DNase_LNCaP_24U.bam.Counts.bed > results/LNCaP/Peaks/macs2_peaks.narrowPeak.sorted.USC20140207_DNase_LNCaP_24U.bam.Counts.bed.tmp && mv results/LNCaP/Peaks/macs2_peaks.narrowPeak.sorted.USC20140207_DNase_LNCaP_24U.bam.Counts.bed.tmp results/LNCaP/Peaks/macs2_peaks.narrowPeak.sorted.USC20140207_DNase_LNCaP_24U.bam.Counts.bed
Running piped cmds: ['bedtools sort -i results/LNCaP/Peaks/macs2_peaks.narrowPeak.sorted.USC20140207_DNase_LNCaP_24U.bam.Counts.bed -faidx reference/hg38/GRCh38_EBV.no_alt.chrom.sizes.tsv', 'bedtools merge -i stdin -c 4 -o max', 'sort -nr -k 4', 'head -n 150000', 'bedtools intersect -b stdin -a results/LNCaP/Peaks/macs2_peaks.narrowPeak.sorted -wa', 'awk \'{{print $1 "\\t" $2 + $10 "\\t" $2 + $10}}\'', 'bedtools slop -i stdin -b 250 -g reference/hg38/GRCh38_EBV.no_alt.chrom.sizes.tsv', 'bedtools sort -i stdin -faidx reference/hg38/GRCh38_EBV.no_alt.chrom.sizes.tsv', 'bedtools merge -i stdin', 'bedtools intersect -v -wa -a stdin -b reference/hg38/GRCh38_unified_blacklist.bed', 'cut -f 1-3', '(bedtools intersect -a reference/hg38/CollapsedGeneBounds.hg38.TSS500bp.bed -b results/tmp/reference/hg38/GRCh38_EBV.no_alt.chrom.sizes.tsv.bed -wa | cut -f 1-3 && cat)', 'bedtools sort -i stdin -faidx reference/hg38/GRCh38_EBV.no_alt.chrom.sizes.tsv', 'bedtools merge -i stdin > results/LNCaP/Peaks/macs2_peaks.narrowPeak.sorted.candidateRegions.bed']
Namespace(candidate_enhancer_regions='results/LNCaP/Peaks/macs2_peaks.narrowPeak.sorted.candidateRegions.bed', outdir='results/LNCaP/Neighborhoods', genes='results/LNCaP/processed_genes_file.bed', genes_for_class_assignment=None, ubiquitously_expressed_genes='reference/UbiquitouslyExpressedGenes.txt', gene_name_annotations='symbol', primary_gene_identifier='symbol', skip_gene_counts=False, H3K27ac='data/LNCaP_bam_files/USC20130125_LNCaP_H3K27ac.bam', DHS='data/LNCaP_bam_files/USC20140207_DNase_LNCaP_24U.bam', ATAC=None, default_accessibility_feature='DHS', expression_table='', qnorm='reference/EnhancersQNormRef.K562.txt', tss_slop_for_class_assignment=500, skip_rpkm_quantile=False, use_secondary_counting_method=False, chrom_sizes='reference/hg38/GRCh38_EBV.no_alt.chrom.sizes.tsv', chrom_sizes_bed='results/tmp/reference/hg38/GRCh38_EBV.no_alt.chrom.sizes.tsv.bed', enhancer_class_override=None, supplementary_features=None, cellType=None)
Running command: bedtools sort -faidx reference/hg38/GRCh38_EBV.no_alt.chrom.sizes.tsv -i results/LNCaP/Neighborhoods/GeneList.TSS1kb.bed > results/LNCaP/Neighborhoods/GeneList.TSS1kb.bed.sorted; mv results/LNCaP/Neighborhoods/GeneList.TSS1kb.bed.sorted results/LNCaP/Neighborhoods/GeneList.TSS1kb.bed
Generating results/LNCaP/Neighborhoods/Genes.H3K27ac.USC20130125_LNCaP_H3K27ac.bam.CountReads.bedgraph
Counting coverage for Genes.H3K27ac.USC20130125_LNCaP_H3K27ac.bam
Running command: awk 'BEGIN {FS=OFS="\t"} (substr($1, length($1)) == "X" || substr($1, length($1)) == "Y") { $4 *= 2 } 1' results/LNCaP/Neighborhoods/Genes.H3K27ac.USC20130125_LNCaP_H3K27ac.bam.CountReads.bedgraph > results/LNCaP/Neighborhoods/Genes.H3K27ac.USC20130125_LNCaP_H3K27ac.bam.CountReads.bedgraph.tmp && mv results/LNCaP/Neighborhoods/Genes.H3K27ac.USC20130125_LNCaP_H3K27ac.bam.CountReads.bedgraph.tmp results/LNCaP/Neighborhoods/Genes.H3K27ac.USC20130125_LNCaP_H3K27ac.bam.CountReads.bedgraph
Feature H3K27ac completed in 21.997461557388306
Generating results/LNCaP/Neighborhoods/Genes.DHS.USC20140207_DNase_LNCaP_24U.bam.CountReads.bedgraph
Counting coverage for Genes.DHS.USC20140207_DNase_LNCaP_24U.bam
Running command: awk 'BEGIN {FS=OFS="\t"} (substr($1, length($1)) == "X" || substr($1, length($1)) == "Y") { $4 *= 2 } 1' results/LNCaP/Neighborhoods/Genes.DHS.USC20140207_DNase_LNCaP_24U.bam.CountReads.bedgraph > results/LNCaP/Neighborhoods/Genes.DHS.USC20140207_DNase_LNCaP_24U.bam.CountReads.bedgraph.tmp && mv results/LNCaP/Neighborhoods/Genes.DHS.USC20140207_DNase_LNCaP_24U.bam.CountReads.bedgraph.tmp results/LNCaP/Neighborhoods/Genes.DHS.USC20140207_DNase_LNCaP_24U.bam.CountReads.bedgraph
Feature DHS completed in 59.77969002723694
Generating results/LNCaP/Neighborhoods/Genes.TSS1kb.H3K27ac.USC20130125_LNCaP_H3K27ac.bam.CountReads.bedgraph
Counting coverage for Genes.TSS1kb.H3K27ac.USC20130125_LNCaP_H3K27ac.bam
Running command: awk 'BEGIN {FS=OFS="\t"} (substr($1, length($1)) == "X" || substr($1, length($1)) == "Y") { $4 *= 2 } 1' results/LNCaP/Neighborhoods/Genes.TSS1kb.H3K27ac.USC20130125_LNCaP_H3K27ac.bam.CountReads.bedgraph > results/LNCaP/Neighborhoods/Genes.TSS1kb.H3K27ac.USC20130125_LNCaP_H3K27ac.bam.CountReads.bedgraph.tmp && mv results/LNCaP/Neighborhoods/Genes.TSS1kb.H3K27ac.USC20130125_LNCaP_H3K27ac.bam.CountReads.bedgraph.tmp results/LNCaP/Neighborhoods/Genes.TSS1kb.H3K27ac.USC20130125_LNCaP_H3K27ac.bam.CountReads.bedgraph
Feature H3K27ac completed in 8.904318571090698
Generating results/LNCaP/Neighborhoods/Genes.TSS1kb.DHS.USC20140207_DNase_LNCaP_24U.bam.CountReads.bedgraph
Counting coverage for Genes.TSS1kb.DHS.USC20140207_DNase_LNCaP_24U.bam
Running command: awk 'BEGIN {FS=OFS="\t"} (substr($1, length($1)) == "X" || substr($1, length($1)) == "Y") { $4 *= 2 } 1' results/LNCaP/Neighborhoods/Genes.TSS1kb.DHS.USC20140207_DNase_LNCaP_24U.bam.CountReads.bedgraph > results/LNCaP/Neighborhoods/Genes.TSS1kb.DHS.USC20140207_DNase_LNCaP_24U.bam.CountReads.bedgraph.tmp && mv results/LNCaP/Neighborhoods/Genes.TSS1kb.DHS.USC20140207_DNase_LNCaP_24U.bam.CountReads.bedgraph.tmp results/LNCaP/Neighborhoods/Genes.TSS1kb.DHS.USC20140207_DNase_LNCaP_24U.bam.CountReads.bedgraph
Feature DHS completed in 15.810325622558594
Generating results/LNCaP/Neighborhoods/Enhancers.H3K27ac.USC20130125_LNCaP_H3K27ac.bam.CountReads.bedgraph
Counting coverage for Enhancers.H3K27ac.USC20130125_LNCaP_H3K27ac.bam
Running command: awk 'BEGIN {FS=OFS="\t"} (substr($1, length($1)) == "X" || substr($1, length($1)) == "Y") { $4 *= 2 } 1' results/LNCaP/Neighborhoods/Enhancers.H3K27ac.USC20130125_LNCaP_H3K27ac.bam.CountReads.bedgraph > results/LNCaP/Neighborhoods/Enhancers.H3K27ac.USC20130125_LNCaP_H3K27ac.bam.CountReads.bedgraph.tmp && mv results/LNCaP/Neighborhoods/Enhancers.H3K27ac.USC20130125_LNCaP_H3K27ac.bam.CountReads.bedgraph.tmp results/LNCaP/Neighborhoods/Enhancers.H3K27ac.USC20130125_LNCaP_H3K27ac.bam.CountReads.bedgraph
Feature H3K27ac completed in 49.30581712722778
Generating results/LNCaP/Neighborhoods/Enhancers.DHS.USC20140207_DNase_LNCaP_24U.bam.CountReads.bedgraph
Counting coverage for Enhancers.DHS.USC20140207_DNase_LNCaP_24U.bam
Running command: awk 'BEGIN {FS=OFS="\t"} (substr($1, length($1)) == "X" || substr($1, length($1)) == "Y") { $4 *= 2 } 1' results/LNCaP/Neighborhoods/Enhancers.DHS.USC20140207_DNase_LNCaP_24U.bam.CountReads.bedgraph > results/LNCaP/Neighborhoods/Enhancers.DHS.USC20140207_DNase_LNCaP_24U.bam.CountReads.bedgraph.tmp && mv results/LNCaP/Neighborhoods/Enhancers.DHS.USC20140207_DNase_LNCaP_24U.bam.CountReads.bedgraph.tmp results/LNCaP/Neighborhoods/Enhancers.DHS.USC20140207_DNase_LNCaP_24U.bam.CountReads.bedgraph
Feature DHS completed in 120.02363634109497
Assigning classes to enhancers
Total enhancers: 153199
         Promoters: 21943
         Genic: 56220
         Intergenic: 75036
Neighborhoods Complete! 

